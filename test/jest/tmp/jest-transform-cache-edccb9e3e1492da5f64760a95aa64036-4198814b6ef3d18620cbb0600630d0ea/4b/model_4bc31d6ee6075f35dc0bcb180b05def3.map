{"version":3,"sources":["model.js"],"names":["parseWeekFromDay1","startDate","dayNo","f","plusDays","firstWeekDay","day","minusDays","dayOfWeek","value","parseWeekFromAnyDay","getWeekHeaders","date","toString","toLowerCase","substr","isWithinRange","endDate","isAfter","isEqual","isBefore","isSelectable","allowedStartDate","allowedEndDate","populateMonthDisplay","conf","monthNo","displayDate","month","dayOfMonth","inMonth","unselectable","selected","selectedStartDate","selectedEndDate","selectedEdge","getDisplayDate","nowDate","now","until","DAYS","getFirstDayOfMonth","getModelByDate","config","parse","undefined","weekHeaders","monthDisplay","console","log"],"mappings":"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","file":"model.js","sourcesContent":["import { LocalDate, ChronoUnit } from 'js-joda'\r\n\r\nexport const parseWeekFromDay1 = (startDate, dayNo = 0) => f => {\r\n    if (dayNo < 7) {\r\n        return [ f(startDate.plusDays(dayNo)), ...(parseWeekFromDay1(startDate, dayNo + 1)(f) || []) ]\r\n    }\r\n}\r\n\r\nexport const firstWeekDay = (day) => day.minusDays(day.dayOfWeek().value() - 1)\r\n\r\nconst parseWeekFromAnyDay =(day => parseWeekFromDay1(firstWeekDay(day)))\r\n\r\nconst getWeekHeaders = day => parseWeekFromAnyDay(day)((date) => date.dayOfWeek().toString().toLowerCase().substr(0, 2))\r\n\r\nexport const isWithinRange = (date, startDate, endDate) => startDate && endDate\r\n    && (date.isAfter(startDate) || date.isEqual(startDate)) && (date.isBefore(endDate) || date.isEqual(endDate))\r\n\r\nexport const isSelectable = (date, { allowedStartDate, allowedEndDate}) => (!allowedStartDate\r\n    || (date.isEqual(allowedStartDate) || date.isAfter(allowedStartDate)))\r\n    && (!allowedEndDate\r\n    || (date.isEqual(allowedEndDate) || date.isBefore(allowedEndDate)))\r\n\r\nexport const populateMonthDisplay = (conf, monthNo = conf.displayDate.month().value()) => {\r\n    if (firstWeekDay(conf.displayDate).month().value() <= monthNo) {\r\n        return [\r\n            parseWeekFromAnyDay(conf.displayDate)((date) => ({\r\n                dayNo: date.dayOfMonth(),\r\n                inMonth: date.month().value() === monthNo,\r\n                unselectable: !isSelectable(date, conf),\r\n                selected: isWithinRange(date, conf.selectedStartDate, conf.selectedEndDate),\r\n                selectedEdge: conf.selectedStartDate && conf.selectedEndDate\r\n                    && (date.isEqual(conf.selectedStartDate) || date.isEqual(conf.selectedEndDate))\r\n            })),\r\n            ...populateMonthDisplay({\r\n                ...conf,\r\n                displayDate: conf.displayDate.plusDays(7),\r\n            }, monthNo)\r\n        ]\r\n    } else {\r\n        return []\r\n    }\r\n}\r\n\r\nconst getDisplayDate = ({ displayDate, selectedStartDate, selectedEndDate }) => {\r\n    if (displayDate) return displayDate\r\n    const nowDate = LocalDate.now()\r\n    if (!selectedStartDate) return nowDate\r\n    return nowDate.until(selectedStartDate, ChronoUnit.DAYS) < nowDate.until(selectedEndDate, ChronoUnit.DAYS)\r\n        ? selectedStartDate : selectedEndDate\r\n}\r\n\r\nconst getFirstDayOfMonth = (date) => date.minusDays(date.dayOfMonth() - 1)\r\n\r\nexport const getModelByDate = (config = {}) => {\r\n    const conf = {\r\n        displayDate: config.displayDate ? LocalDate.parse(config.displayDate): undefined,\r\n        selectedStartDate: config.selectedStartDate ? LocalDate.parse(config.selectedStartDate): undefined,\r\n        selectedEndDate: config.selectedEndDate ? LocalDate.parse(config.selectedEndDate): undefined,\r\n        allowedStartDate: config.allowedStartDate ? LocalDate.parse(config.allowedStartDate): undefined,\r\n        allowedEndDate: config.allowedEndDate ? LocalDate.parse(config.allowedEndDate): undefined\r\n    }\r\n    conf.displayDate = getFirstDayOfMonth(getDisplayDate(conf))\r\n    const weekHeaders = getWeekHeaders(conf.displayDate)\r\n    const monthDisplay = populateMonthDisplay(conf)\r\n    console.log('monthDisplay: ', monthDisplay)\r\n\r\n    return { weekHeaders, monthDisplay }\r\n}\r\n"]}